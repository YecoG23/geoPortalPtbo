{% extends "base.html" %}
{% load static %}

{% block title %}Inicio{% endblock title %}

{% block custom_style %}
<style>
	#mapid { height: 500px; }
</style>
{% endblock custom_style %}

{% block content %}

<div>
	<div class="container-fluid" id="mapid">
	</div>
</div>

<script>
	var dataurl = "{% url 'data' %}";
    // Download GeoJSON via Ajax
    $.getJSON(dataurl, function (data) {
    	var mymap = L.map('mapid').setView([-10.774303, -75.813227], 13);
    	L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoieWVjbzIzIiwiYSI6ImNrNnZvdnNhdjAwM2Uza285cnVzejFnbGcifQ.NY_Z2Zm2h7wH2LWo9-HGCw', {
    		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
    		maxZoom: 18,
    		id: 'mapbox/streets-v11',
    		tileSize: 512,
    		zoomOffset: -1,
    		accessToken: 'your.mapbox.access.token'
    	}).addTo(mymap);

    	var marker = L.marker([-10.774303, -75.813227]).addTo(mymap);
    	marker.bindPopup("<b>Hello world!</b><br>I am a popup.").openPopup();

	// var popup = L.popup();

	// function onMapClick(e) {
	// 	popup
	// 	.setLatLng(e.latlng)
	// 	.setContent("You clicked the map at " + e.latlng.toString())
	// 	.openOn(mymap);
	// }

	// mymap.on('click', onMapClick);


        // Add GeoJSON layer
        L.geoJson(data).addTo(mymap);
    });

</script>

{% endblock %}